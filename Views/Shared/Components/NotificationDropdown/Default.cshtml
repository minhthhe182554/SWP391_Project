@model SWP391_Project.ViewModels.Notification.NotificationDropdownVM

<div class="dropdown">
    <a class="nav-link d-flex align-items-center position-relative" href="#" id="notificationDropdown" role="button" data-bs-toggle="dropdown" aria-expanded="false" style="cursor: pointer; padding: 0.25rem 0.5rem; text-decoration: none;">
        <img src="~/imgs/ic_notification.png" alt="Thông báo" style="width: 24px; height: 24px; object-fit: contain;" />
        @if (Model.UnreadCount > 0)
        {
            <span class="position-absolute top-0 start-100 translate-middle badge rounded-pill bg-danger" style="font-size: 0.7rem;">
                @Model.UnreadCount
            </span>
        }
    </a>

    <ul class="dropdown-menu dropdown-menu-end" aria-labelledby="notificationDropdown" style="border-radius: 10px; border: 1px solid #ced4da; margin-top: 0.5rem; min-width: 460px; max-width: 560px; max-height: 520px; overflow-y: auto; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
        <li class="dropdown-header" style="padding: 1rem; border-bottom: 1px solid #e9ecef; font-weight: 600; color: #495057;">
            Thông báo
        </li>

        @if (Model.Items == null || !Model.Items.Any())
        {
            <li>
                <div class="p-3 text-center text-muted" style="min-height: 100px; display: flex; align-items: center; justify-content: center;">
                    <div>
                        <i class="fa fa-bell-slash" style="font-size: 2rem; color: #ced4da; margin-bottom: 0.5rem;"></i>
                        <p style="margin: 0;">Chưa có thông báo nào</p>
                    </div>
                </div>
            </li>
        }
        else
        {
            foreach (var n in Model.Items)
            {
                var itemStyle = n.Read ? "" : "background: #eaf7f0;";
                <li>
                    @if (n.NavigationId.HasValue)
                    {
                        <a class="dropdown-item" asp-controller="Notification" asp-action="Open" asp-route-id="@n.Id" style="white-space: normal; padding: 0.75rem 1rem; border-bottom: 1px solid #e9ecef; @itemStyle">
                            <div class="fw-semibold" style="display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;">
                                @n.Title
                            </div>
                            @if (!n.Read)
                            {
                                <small class="text-success fw-semibold">Mới</small>
                            }
                        </a>
                    }
                    else
                    {
                        <div class="dropdown-item" style="white-space: normal; padding: 0.75rem 1rem; border-bottom: 1px solid #e9ecef; opacity: 0.7; cursor: default; @itemStyle">
                            <div class="fw-semibold" style="display: -webkit-box; -webkit-line-clamp: 2; -webkit-box-orient: vertical; overflow: hidden;">
                                @n.Title
                            </div>
                            @if (!n.Read)
                            {
                                <small class="text-success fw-semibold">Mới</small>
                            }
                        </div>
                    }
                </li>
            }

            <li><hr class="dropdown-divider" /></li>
            <li>
                <a class="dropdown-item text-center" asp-controller="Notification" asp-action="Index" style="padding: 0.75rem 1rem; font-weight: 600;">
                    Xem tất cả
                </a>
            </li>
        }
    </ul>
</div>
